---
title: "DATA 606 Final Data Project"
author: "Stephen Haslett"
date: "11/29/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=FALSE, warning=FALSE}
library(tidyverse)
library(knitr)
library(kableExtra)
library(stringr)
library(DT)
library(tools)
#Check if needed
library(ggplot2)
library(ggthemes)
```

### Part 1 - Introduction


### Part 2 - Data

**The original data was collected by the U.S. Census Bureau as part of the 2010-2012 American Community Survey (ACS). FiveThirtyEight (https://fivethirtyeight.com) used this data to construct a new dataset that acted as the factual foundation for their “The Economic Guide To Picking A College Major” (https://fivethirtyeight.com/features/the-economic-guide-to-picking-a-college-major) story. This data project will utilize FiveThirtyEight’s version of the data.**

**The dataset can be found at the following location - https://github.com/fivethirtyeight/data/blob/master/college-majors/all-ages.csv**


### Salary Increase by Major dataset.

```{r, message=FALSE, warning=FALSE}
category_csv <- 'https://raw.githubusercontent.com/stephen-haslett/data606/data606-final-project/final_data_project/degrees-that-pay-back.csv'
salary_by_major <- read.csv(url(category_csv), header = TRUE)

datatable(salary_by_major)
```



### Employment Data for Recent Graduates dataset.

```{r, message=FALSE, warning=FALSE}
recent_grads_csv <- 'https://raw.githubusercontent.com/stephen-haslett/data606/data606-final-project/final_data_project/recent-grads.csv'
recent_grads_employment <- read.csv(url(recent_grads_csv), header = TRUE)

# In order to make Major titles uniform across all datasets, we convert titles to title case,
# and convert instances of the word 'and' to ampersands.
recent_grads_employment$Major <- tolower(recent_grads_employment$Major)
recent_grads_employment$Major <- toTitleCase(recent_grads_employment$Major)
recent_grads_employment$Major <- gsub(" and "," & ", recent_grads_employment$Major)

datatable(recent_grads_employment)
```


### Employment Data for All Graduates dataset.

```{r, message=FALSE, warning=FALSE}
grad_employment_csv <- 'https://raw.githubusercontent.com/stephen-haslett/data606/data606-final-project/final_data_project/all-ages.csv'
all_grads_employment <- read.csv(url(grad_employment_csv), header = TRUE)

# Convert Major titles to title case, and convert instances of the word 'and' to ampersands.
all_grads_employment$Major <- tolower(all_grads_employment$Major)
all_grads_employment$Major <- toTitleCase(all_grads_employment$Major)
all_grads_employment$Major <- as.character(gsub(" and "," & ", all_grads_employment$Major))

datatable(all_grads_employment)
```

### Part 3 - Exploratory data analysis


#### Highest Unemployment rates by major.
```{r, message=FALSE, warning=FALSE}
unemployment_by_major <- top_n(all_grads_employment, 20, Unemployment_rate)
unemployment_by_major_plot <- ggplot(unemployment_by_major, aes(x = reorder(Major, - Unemployment_rate), y = Unemployment_rate)) +
   geom_bar(stat = 'identity', fill = 'red') +
    labs(title = 'Highest Unemployment Rates by Major',
         x = 'Major',
         y = 'Unemployment Rate') +
    theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
    theme(panel.background = element_rect(fill = '#FFFFFF'))

unemployment_by_major_plot
```


#### Lowest Unemployment rates by major.
```{r, message=FALSE, warning=FALSE}
lowest_unemployment_by_major <- top_n(all_grads_employment, - 20, Unemployment_rate)
lowest_unemployment_by_major_plot <- ggplot(lowest_unemployment_by_major, aes(x = reorder(Major, + Unemployment_rate), y = Unemployment_rate)) +
   geom_bar(stat = 'identity', fill = 'blue') +
    labs(title = 'Lowest Unemployment Rates by Major',
         x = 'Major',
         y = 'Unemployment Rate') +
    theme(axis.text.x = element_text(angle = 70, hjust = 1)) +
    theme(panel.background = element_rect(fill = '#FFFFFF'))

lowest_unemployment_by_major_plot
```


#### Median income summary
```{r, message=FALSE, warning=FALSE}
summary(all_grads_employment$Median)
```


```{r, message=FALSE, warning=FALSE}
median_income_plot <- ggplot(all_grads_employment, aes(x = Median)) +
    geom_histogram(binwidth = 10000, color = "#FFFFFF", fill = "#4CAF50") +
    labs(title = "Median Income for All Majors",
         x = "Median Income",
         y = 'Frequency') +
    theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
    theme(panel.background = element_rect(fill = '#FFFFFF'))

median_income_plot
```


#### Median income by major

```{r, message=FALSE, warning=FALSE}
highest_income_by_major <- top_n(all_grads_employment, 20, Median)
highest_income_by_major_plot <- ggplot(highest_income_by_major, aes(x = reorder(Major, - Median), y = Median)) +
   geom_bar(stat = 'identity', fill = '#01BEFE') +
    labs(title = 'Highest Median Incomes by Major',
         x = 'Major',
         y = 'Median Income') +
    theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
    theme(panel.background = element_rect(fill = '#FFFFFF'))

highest_income_by_major_plot
```




```{r, message=FALSE, warning=FALSE}
lowest_income_by_major <- top_n(all_grads_employment, -20, Median)
lowest_income_by_major_plot <- ggplot(lowest_income_by_major, aes(x = reorder(Major, + Median), y = Median)) +
   geom_bar(stat = 'identity', fill = '#800080') +
    labs(title = 'Lowest Median Incomes by Major',
         x = 'Major',
         y = 'Median Income') +
    theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
    theme(panel.background = element_rect(fill = '#FFFFFF'))

lowest_income_by_major_plot
```

### Part 4 - Inference


### Part 5 - Conclusion